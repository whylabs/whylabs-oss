import { useRef, useEffect, useCallback, useMemo } from 'react';
import { SelectAutoCompleteWithLabel } from 'components/select-autocomplete/SelectAutoCompleteWithLabel';
import { useRecoilState } from 'recoil';
import { customMonitorAtom } from 'atoms/customMonitorAtom';
import { ISelectItem } from 'components/select-autocomplete/SelectAutoComplete';
import { TimePeriod, useGetBatchFrequencyQuery } from 'generated/graphql';
import { usePageTypeWithParams } from 'pages/page-types/usePageType';
import { timePeriodToGranularity } from 'adapters/monitor-adapters';
import { WhyLabsText } from 'components/design-system';
import { ColumnCardContentProps } from '../../phaseCard';
import useCustomMonitorManagerCSS from '../../../useCustomMonitorManagerCSS';
import { TrailingWindowOption, trailingWindowOptions } from '../../../CustomMonitorTypes';
import ReadModeMonitorManager from '../../ReadModeMonitorManager';

// Trailing window component
const TrailingWindowComponent = ({
  setContentHeight,
  isPhaseActive,
  setHasChanged,
  setWidthSpan,
}: ColumnCardContentProps): JSX.Element => {
  const { classes: styles } = useCustomMonitorManagerCSS();
  const [{ baselineWindowSize, granularity }, setRecoilState] = useRecoilState(customMonitorAtom);
  const ref = useRef<HTMLDivElement>(null);
  const { modelId } = usePageTypeWithParams();
  const { data: batchFrequency } = useGetBatchFrequencyQuery({ variables: { modelId } });
  const usedTrailingWindowOptions = useMemo(() => {
    return [...trailingWindowOptions[granularity]];
  }, [granularity]);

  useEffect(() => {
    setRecoilState((prev) => ({
      ...prev,
      granularity: timePeriodToGranularity(batchFrequency?.model?.batchFrequency ?? TimePeriod.P1D),
    }));
  }, [batchFrequency, setRecoilState]);

  useEffect(() => {
    if (ref.current) {
      setContentHeight(ref.current.clientHeight || 0);
      setWidthSpan(2);
    }
    if (!ref.current) {
      setWidthSpan(1);
    }
  }, [ref.current?.clientHeight, setContentHeight, isPhaseActive, isPhaseActive, setWidthSpan]);

  const setBaselineWindowSize = useCallback(
    (newValue: TrailingWindowOption) => {
      setRecoilState((prevState) => ({
        ...prevState,
        baselineWindowSize: newValue,
      }));
    },
    [setRecoilState],
  );

  useEffect(() => {
    if (!baselineWindowSize && batchFrequency) {
      const initialValue = usedTrailingWindowOptions.find((o) => o.default);
      if (initialValue) setBaselineWindowSize(initialValue.value);
    }
  }, [baselineWindowSize, batchFrequency, setBaselineWindowSize, usedTrailingWindowOptions]);

  const onChangeTrailingWindow = (item: ISelectItem | null) => {
    if (item) setBaselineWindowSize(item.value as TrailingWindowOption);
    setHasChanged(true);
  };

  if (!isPhaseActive)
    return (
      <ReadModeMonitorManager
        label="Trailing window"
        text={usedTrailingWindowOptions.find((opt) => opt.value === baselineWindowSize)?.label || ''}
      />
    );

  return (
    <div ref={ref} className={styles.columnCardContentWrap}>
      <WhyLabsText inherit className={styles.columnCardTitle}>
        Trailing window
      </WhyLabsText>
      {granularity === 'daily' && <TrailingWindowChart days={Number(baselineWindowSize) || 0} />}
      <SelectAutoCompleteWithLabel
        id="trailingWindow"
        label="Trailing window duration:"
        value={usedTrailingWindowOptions.find((item) => item.value === baselineWindowSize)}
        onChange={onChangeTrailingWindow}
        options={usedTrailingWindowOptions as ISelectItem[]}
        required
      />
      <WhyLabsText inherit className={styles.columnCardText}>
        A dynamic trailing window will be used to create a <b>baseline from today</b>
      </WhyLabsText>
    </div>
  );
};

export default TrailingWindowComponent;

interface TrailingWindowChartProps {
  days: number;
}

function TrailingWindowChart({ days }: TrailingWindowChartProps) {
  return (
    <svg viewBox="0 0 486 109" fill="none" xmlns="http://www.w3.org/2000/svg">
      {Array.from({ length: Math.min(days, 30) }).map((_, rectIndex) => {
        const rectWidth = 14.8404;
        const verticalLineWidth = 1.64894;
        const firstRectX = 462.159;
        const currentRectX = firstRectX - (rectWidth + verticalLineWidth) * rectIndex;

        return (
          <rect
            // eslint-disable-next-line react/no-array-index-key
            key={`rect-index-${rectIndex}`}
            x={currentRectX}
            y="23"
            width={rectWidth}
            height="65.9574"
            fill="#F5843C"
          />
        );
      })}

      <rect x="460.511" y="23" width="1.64894" height="65.9574" fill="#EBF2F3" />
      <rect x="444.021" y="23" width="1.64894" height="65.9574" fill="#EBF2F3" />
      <rect x="427.532" y="23" width="1.64894" height="65.9574" fill="#EBF2F3" />
      <rect x="411.043" y="23" width="1.64894" height="65.9574" fill="#EBF2F3" />
      <rect x="394.553" y="23" width="1.64894" height="65.9574" fill="#EBF2F3" />
      <rect x="378.064" y="23" width="1.64894" height="65.9574" fill="#EBF2F3" />
      <rect x="361.574" y="23" width="1.64894" height="65.9574" fill="#EBF2F3" />
      <rect x="345.085" y="23" width="1.64894" height="65.9574" fill="#EBF2F3" />
      <rect x="328.596" y="23" width="1.64894" height="65.9574" fill="#EBF2F3" />
      <rect x="312.106" y="23" width="1.64894" height="65.9574" fill="#EBF2F3" />
      <rect x="295.617" y="23" width="1.64894" height="65.9574" fill="#EBF2F3" />
      <rect x="279.127" y="23" width="1.64894" height="65.9574" fill="#EBF2F3" />
      <rect x="262.638" y="23" width="1.64894" height="65.9574" fill="#EBF2F3" />
      <rect x="246.149" y="23" width="1.64894" height="65.9574" fill="#EBF2F3" />
      <rect x="229.66" y="23" width="1.64894" height="65.9574" fill="#EBF2F3" />
      <rect x="213.17" y="23" width="1.64894" height="65.9574" fill="#EBF2F3" />
      <rect x="196.681" y="23" width="1.64894" height="65.9574" fill="#EBF2F3" />
      <rect x="181.84" y="23" width="1.64894" height="65.9574" fill="#EBF2F3" />
      <rect x="163.702" y="23" width="1.64894" height="65.9574" fill="#EBF2F3" />
      <rect x="147.213" y="23" width="1.64894" height="65.9574" fill="#EBF2F3" />
      <rect x="130.724" y="23" width="1.64894" height="65.9574" fill="#EBF2F3" />
      <rect x="114.234" y="23" width="1.64894" height="65.9574" fill="#EBF2F3" />
      <rect x="97.7446" y="23" width="1.64894" height="65.9574" fill="#EBF2F3" />
      <rect x="81.2554" y="23" width="1.64894" height="65.9574" fill="#EBF2F3" />
      <rect x="64.7661" y="23" width="1.64894" height="65.9574" fill="#EBF2F3" />
      <rect x="48.2764" y="23" width="1.64894" height="65.9574" fill="#EBF2F3" />
      <rect x="31.7871" y="23" width="1.64894" height="65.9574" fill="#EBF2F3" />
      <rect x="15.2979" y="23" width="1.64894" height="65.9574" fill="#EBF2F3" />
      <path
        d="M472.053 52.6809L455.564 46.0851L439.899 51.0319L422.585 65.0479L406.096 51.0319H389.607L373.117 41.1383L356.628 59.2766L340.139 55.1543L322 53.5053L303.862 59.2766L288.197 53.5053L271.708 51.8564L254.394 55.1543L238.729 41.1383L222.24 53.5053L204.926 55.9787L190.5 53.5053L173.5 61L156 53.5053L139 59.2766L123.5 55.9787H107L90.5 59.2766L74 63L58 55.9787L41 51.0319L24 61"
        stroke="#005566"
        strokeWidth="1.64894"
      />
      <path
        d="M361.864 14C361.744 14 361.656 13.976 361.6 13.928C361.552 13.872 361.532 13.78 361.54 13.652L362.344 5.972C362.352 5.844 362.388 5.752 362.452 5.696C362.516 5.632 362.612 5.6 362.74 5.6H366.964C367.124 5.6 367.2 5.712 367.192 5.936L367.18 6.116C367.156 6.38 367.052 6.512 366.868 6.512H363.34L363.052 9.248H366.196C366.356 9.248 366.432 9.36 366.424 9.584L366.412 9.764C366.388 10.028 366.284 10.16 366.1 10.16H362.956L362.656 13.088H366.196C366.356 13.088 366.432 13.2 366.424 13.424L366.412 13.604C366.388 13.868 366.284 14 366.1 14H361.864ZM367.995 14.024C367.811 14.024 367.675 14.012 367.587 13.988C367.507 13.956 367.467 13.908 367.467 13.844C367.467 13.764 367.503 13.684 367.575 13.604L369.819 10.784L368.307 8.12C368.251 8.024 368.223 7.952 368.223 7.904C368.239 7.832 368.287 7.78 368.367 7.748C368.455 7.716 368.599 7.7 368.799 7.7H368.907C369.043 7.7 369.151 7.712 369.231 7.736C369.311 7.76 369.371 7.808 369.411 7.88L370.167 9.188C370.367 9.54 370.499 9.808 370.563 9.992C370.691 9.744 370.863 9.488 371.079 9.224L372.159 7.868C372.239 7.756 372.415 7.7 372.687 7.7H372.759C373.111 7.7 373.287 7.76 373.287 7.88C373.287 7.944 373.251 8.024 373.179 8.12L371.079 10.76L372.723 13.604C372.779 13.684 372.807 13.756 372.807 13.82C372.791 13.892 372.739 13.944 372.651 13.976C372.571 14.008 372.431 14.024 372.231 14.024H372.123C371.987 14.024 371.879 14.012 371.799 13.988C371.719 13.964 371.659 13.916 371.619 13.844L370.707 12.26C370.515 11.916 370.399 11.672 370.359 11.528C370.279 11.704 370.127 11.928 369.903 12.2L368.595 13.856C368.507 13.968 368.331 14.024 368.067 14.024H367.995ZM375.742 14.072C375.438 14.072 375.134 13.996 374.83 13.844C374.526 13.684 374.266 13.412 374.05 13.028C373.842 12.644 373.738 12.128 373.738 11.48C373.738 10.736 373.858 10.076 374.098 9.5C374.346 8.916 374.69 8.464 375.13 8.144C375.578 7.816 376.094 7.652 376.678 7.652C377.238 7.652 377.746 7.868 378.202 8.3C378.274 8.084 378.342 7.932 378.406 7.844C378.478 7.748 378.59 7.7 378.742 7.7H378.814C378.934 7.7 379.014 7.728 379.054 7.784C379.102 7.84 379.118 7.936 379.102 8.072L378.634 12.716C378.594 13.06 378.698 13.232 378.946 13.232C379.042 13.232 379.13 13.22 379.21 13.196C379.298 13.164 379.358 13.148 379.39 13.148C379.438 13.148 379.462 13.18 379.462 13.244C379.462 13.356 379.446 13.5 379.414 13.676C379.39 13.812 379.298 13.912 379.138 13.976C378.986 14.04 378.838 14.072 378.694 14.072C378.31 14.072 378.03 13.964 377.854 13.748C377.678 13.532 377.598 13.208 377.614 12.776C377.382 13.224 377.102 13.552 376.774 13.76C376.454 13.968 376.11 14.072 375.742 14.072ZM375.97 13.196C376.282 13.196 376.602 13.04 376.93 12.728C377.258 12.408 377.534 11.888 377.758 11.168L377.938 9.596C377.962 9.348 377.99 9.148 378.022 8.996C377.63 8.684 377.166 8.528 376.63 8.528C376.23 8.528 375.89 8.664 375.61 8.936C375.338 9.208 375.13 9.564 374.986 10.004C374.85 10.444 374.782 10.912 374.782 11.408C374.782 12.048 374.89 12.508 375.106 12.788C375.322 13.06 375.61 13.196 375.97 13.196ZM389.361 13.148C389.409 13.148 389.433 13.18 389.433 13.244C389.433 13.356 389.417 13.5 389.385 13.676C389.361 13.812 389.269 13.912 389.109 13.976C388.957 14.04 388.809 14.072 388.665 14.072C388.305 14.072 388.033 13.984 387.849 13.808C387.673 13.624 387.585 13.344 387.585 12.968C387.585 12.832 387.589 12.728 387.597 12.656L387.909 9.692C387.917 9.644 387.921 9.572 387.921 9.476C387.921 9.156 387.841 8.92 387.681 8.768C387.521 8.608 387.297 8.528 387.009 8.528C386.713 8.528 386.401 8.672 386.073 8.96C385.745 9.24 385.461 9.704 385.221 10.352L384.861 13.76C384.853 13.848 384.805 13.916 384.717 13.964C384.629 14.004 384.509 14.024 384.357 14.024H384.309C383.989 14.024 383.837 13.932 383.853 13.748L384.285 9.572C384.293 9.532 384.297 9.472 384.297 9.392C384.297 9.096 384.217 8.88 384.057 8.744C383.897 8.6 383.673 8.528 383.385 8.528C383.081 8.528 382.769 8.664 382.449 8.936C382.129 9.208 381.849 9.668 381.609 10.316L381.249 13.76C381.225 13.936 381.057 14.024 380.745 14.024H380.697C380.537 14.024 380.417 14 380.337 13.952C380.257 13.904 380.225 13.836 380.241 13.748L380.337 12.92C380.625 10.344 380.769 8.876 380.769 8.516C380.769 8.372 380.765 8.276 380.757 8.228C380.757 8.172 380.757 8.132 380.757 8.108C380.757 7.996 380.837 7.924 380.997 7.892C381.157 7.852 381.301 7.832 381.429 7.832C381.541 7.832 381.621 7.916 381.669 8.084C381.717 8.244 381.741 8.428 381.741 8.636V8.864C381.997 8.456 382.297 8.152 382.641 7.952C382.993 7.752 383.361 7.652 383.745 7.652C384.241 7.652 384.613 7.768 384.861 8C385.117 8.232 385.269 8.548 385.317 8.948C385.573 8.516 385.881 8.192 386.241 7.976C386.601 7.76 386.977 7.652 387.369 7.652C387.889 7.652 388.281 7.784 388.545 8.048C388.809 8.312 388.941 8.684 388.941 9.164C388.941 9.292 388.937 9.388 388.929 9.452L388.605 12.716C388.565 13.06 388.669 13.232 388.917 13.232C389.013 13.232 389.101 13.22 389.181 13.196C389.269 13.164 389.329 13.148 389.361 13.148ZM393.917 7.652C394.261 7.652 394.601 7.728 394.937 7.88C395.281 8.032 395.569 8.296 395.801 8.672C396.041 9.048 396.161 9.552 396.161 10.184C396.161 10.936 396.037 11.608 395.789 12.2C395.541 12.784 395.189 13.244 394.733 13.58C394.277 13.908 393.749 14.072 393.149 14.072C392.797 14.072 392.485 14.008 392.213 13.88C391.941 13.752 391.713 13.604 391.529 13.436L391.241 16.232C391.225 16.32 391.173 16.384 391.085 16.424C391.005 16.472 390.889 16.496 390.737 16.496H390.689C390.537 16.496 390.421 16.472 390.341 16.424C390.261 16.376 390.225 16.316 390.233 16.244L390.941 9.404C390.989 8.948 391.013 8.652 391.013 8.516C391.013 8.372 391.009 8.276 391.001 8.228C391.001 8.172 391.001 8.132 391.001 8.108C391.001 7.996 391.081 7.924 391.241 7.892C391.401 7.852 391.545 7.832 391.673 7.832C391.881 7.832 391.985 8.132 391.985 8.732V8.876C392.225 8.452 392.509 8.144 392.837 7.952C393.173 7.752 393.533 7.652 393.917 7.652ZM393.005 13.208C393.781 13.208 394.325 12.932 394.637 12.38C394.957 11.82 395.117 11.112 395.117 10.256C395.117 9.104 394.641 8.528 393.689 8.528C393.361 8.528 393.025 8.684 392.681 8.996C392.345 9.308 392.061 9.816 391.829 10.52L391.613 12.668C391.765 12.804 391.957 12.928 392.189 13.04C392.429 13.152 392.701 13.208 393.005 13.208ZM398.84 14.072C398.472 14.072 398.204 13.976 398.036 13.784C397.868 13.592 397.784 13.284 397.784 12.86C397.784 12.708 397.788 12.588 397.796 12.5L398.54 5.24C398.548 5.144 398.592 5.076 398.672 5.036C398.76 4.996 398.884 4.976 399.044 4.976H399.092C399.42 4.976 399.572 5.064 399.548 5.24L398.78 12.716C398.74 13.06 398.844 13.232 399.092 13.232C399.188 13.232 399.276 13.22 399.356 13.196C399.444 13.164 399.504 13.148 399.536 13.148C399.584 13.148 399.608 13.18 399.608 13.244C399.608 13.356 399.592 13.5 399.56 13.676C399.536 13.812 399.444 13.912 399.284 13.976C399.132 14.04 398.984 14.072 398.84 14.072ZM402.804 11.444C402.412 11.444 402.068 11.416 401.772 11.36V11.48C401.772 12.112 401.92 12.56 402.216 12.824C402.52 13.08 402.956 13.208 403.524 13.208C403.86 13.208 404.152 13.164 404.4 13.076C404.648 12.988 404.892 12.876 405.132 12.74C405.268 12.66 405.352 12.62 405.384 12.62C405.416 12.62 405.436 12.628 405.444 12.644C405.46 12.66 405.468 12.7 405.468 12.764C405.468 12.916 405.448 13.096 405.408 13.304C405.376 13.48 405.24 13.624 405 13.736C404.76 13.848 404.492 13.932 404.196 13.988C403.9 14.044 403.648 14.072 403.44 14.072C401.632 14.072 400.728 13.244 400.728 11.588C400.728 10.436 400.996 9.492 401.532 8.756C402.068 8.02 402.876 7.652 403.956 7.652C404.444 7.652 404.844 7.74 405.156 7.916C405.468 8.084 405.692 8.292 405.828 8.54C405.972 8.78 406.044 9.016 406.044 9.248C406.044 10.016 405.736 10.576 405.12 10.928C404.504 11.272 403.732 11.444 402.804 11.444ZM403.92 8.516C403.352 8.516 402.884 8.7 402.516 9.068C402.148 9.428 401.92 9.932 401.832 10.58H402.684C403.188 10.58 403.7 10.504 404.22 10.352C404.74 10.2 405 9.864 405 9.344C405 9.096 404.9 8.896 404.7 8.744C404.5 8.592 404.24 8.516 403.92 8.516ZM411.891 14.024C411.611 14.024 411.455 13.948 411.423 13.796L410.103 7.976C410.079 7.88 410.107 7.812 410.187 7.772C410.275 7.724 410.419 7.7 410.619 7.7H410.679C410.959 7.7 411.115 7.764 411.147 7.892L411.855 11.06C411.983 11.636 412.103 12.252 412.215 12.908H412.275C412.515 12.22 412.751 11.604 412.983 11.06L414.363 7.892C414.395 7.82 414.443 7.772 414.507 7.748C414.571 7.716 414.671 7.7 414.807 7.7H414.975C415.255 7.7 415.395 7.76 415.395 7.88C415.395 7.936 415.379 8 415.347 8.072L412.803 13.832C412.747 13.96 412.583 14.024 412.311 14.024H411.891ZM417.08 14.072C416.8 14.072 416.568 13.984 416.384 13.808C416.208 13.632 416.12 13.352 416.12 12.968C416.12 12.848 416.124 12.756 416.132 12.692L416.6 7.964C416.608 7.868 416.652 7.8 416.732 7.76C416.82 7.72 416.944 7.7 417.104 7.7H417.152C417.32 7.7 417.44 7.724 417.512 7.772C417.584 7.812 417.616 7.876 417.608 7.964L417.14 12.716L417.128 12.86C417.128 12.988 417.152 13.084 417.2 13.148C417.248 13.204 417.324 13.232 417.428 13.232C417.524 13.232 417.612 13.22 417.692 13.196C417.78 13.164 417.84 13.148 417.872 13.148C417.92 13.148 417.944 13.18 417.944 13.244C417.944 13.356 417.928 13.5 417.896 13.676C417.872 13.812 417.776 13.912 417.608 13.976C417.448 14.04 417.272 14.072 417.08 14.072ZM417.2 6.86C416.848 6.86 416.68 6.772 416.696 6.596L416.768 5.876C416.784 5.7 416.972 5.612 417.332 5.612C417.516 5.612 417.644 5.636 417.716 5.684C417.796 5.724 417.832 5.788 417.824 5.876L417.752 6.596C417.736 6.772 417.552 6.86 417.2 6.86ZM420.555 14.072C420.259 14.072 419.979 14.04 419.715 13.976C419.459 13.904 419.255 13.816 419.103 13.712C418.951 13.608 418.875 13.5 418.875 13.388C418.875 13.236 418.891 13.1 418.923 12.98C418.963 12.86 419.011 12.8 419.067 12.8C419.099 12.8 419.191 12.84 419.343 12.92C419.495 13 419.663 13.068 419.847 13.124C420.031 13.18 420.247 13.208 420.495 13.208C420.871 13.208 421.179 13.12 421.419 12.944C421.667 12.768 421.791 12.532 421.791 12.236C421.791 12.028 421.743 11.86 421.647 11.732C421.559 11.604 421.443 11.504 421.299 11.432C421.155 11.36 420.959 11.28 420.711 11.192C419.695 10.832 419.187 10.252 419.187 9.452C419.187 8.9 419.391 8.464 419.799 8.144C420.215 7.816 420.727 7.652 421.335 7.652C421.695 7.652 422.039 7.7 422.367 7.796C422.695 7.892 422.859 8.028 422.859 8.204C422.859 8.308 422.807 8.436 422.703 8.588C422.599 8.732 422.511 8.804 422.439 8.804C422.415 8.804 422.347 8.776 422.235 8.72C422.131 8.664 422.007 8.616 421.863 8.576C421.727 8.536 421.559 8.516 421.359 8.516C420.983 8.516 420.691 8.588 420.483 8.732C420.275 8.876 420.171 9.076 420.171 9.332C420.171 9.524 420.227 9.684 420.339 9.812C420.451 9.94 420.579 10.04 420.723 10.112C420.867 10.184 421.079 10.276 421.359 10.388C421.671 10.508 421.923 10.632 422.115 10.76C422.315 10.88 422.483 11.048 422.619 11.264C422.755 11.48 422.823 11.756 422.823 12.092C422.823 12.46 422.727 12.796 422.535 13.1C422.351 13.396 422.087 13.632 421.743 13.808C421.399 13.984 421.003 14.072 420.555 14.072ZM429.664 13.148C429.712 13.148 429.736 13.18 429.736 13.244C429.736 13.356 429.72 13.5 429.688 13.676C429.664 13.812 429.572 13.912 429.412 13.976C429.26 14.04 429.112 14.072 428.968 14.072C428.624 14.072 428.36 13.98 428.176 13.796C428 13.604 427.896 13.276 427.864 12.812C427.288 13.652 426.584 14.072 425.752 14.072C425.232 14.072 424.84 13.94 424.576 13.676C424.312 13.412 424.18 13.04 424.18 12.56C424.18 12.432 424.184 12.336 424.192 12.272L424.624 7.964C424.632 7.868 424.676 7.8 424.756 7.76C424.844 7.72 424.968 7.7 425.128 7.7H425.176C425.344 7.7 425.464 7.724 425.536 7.772C425.608 7.812 425.64 7.876 425.632 7.964L425.212 12.152C425.204 12.192 425.2 12.252 425.2 12.332C425.2 12.628 425.28 12.848 425.44 12.992C425.6 13.128 425.824 13.196 426.112 13.196C426.448 13.196 426.792 13.04 427.144 12.728C427.504 12.416 427.8 11.892 428.032 11.156L428.368 7.964C428.376 7.868 428.42 7.8 428.5 7.76C428.588 7.72 428.712 7.7 428.872 7.7H428.92C429.088 7.7 429.208 7.724 429.28 7.772C429.352 7.812 429.384 7.876 429.376 7.964L428.908 12.716C428.868 13.06 428.972 13.232 429.22 13.232C429.316 13.232 429.404 13.22 429.484 13.196C429.572 13.164 429.632 13.148 429.664 13.148ZM432.648 14.072C432.344 14.072 432.04 13.996 431.736 13.844C431.432 13.684 431.172 13.412 430.956 13.028C430.748 12.644 430.644 12.128 430.644 11.48C430.644 10.736 430.764 10.076 431.004 9.5C431.252 8.916 431.596 8.464 432.036 8.144C432.484 7.816 433 7.652 433.584 7.652C434.144 7.652 434.652 7.868 435.108 8.3C435.18 8.084 435.248 7.932 435.312 7.844C435.384 7.748 435.496 7.7 435.648 7.7H435.72C435.84 7.7 435.92 7.728 435.96 7.784C436.008 7.84 436.024 7.936 436.008 8.072L435.54 12.716C435.5 13.06 435.604 13.232 435.852 13.232C435.948 13.232 436.036 13.22 436.116 13.196C436.204 13.164 436.264 13.148 436.296 13.148C436.344 13.148 436.368 13.18 436.368 13.244C436.368 13.356 436.352 13.5 436.32 13.676C436.296 13.812 436.204 13.912 436.044 13.976C435.892 14.04 435.744 14.072 435.6 14.072C435.216 14.072 434.936 13.964 434.76 13.748C434.584 13.532 434.504 13.208 434.52 12.776C434.288 13.224 434.008 13.552 433.68 13.76C433.36 13.968 433.016 14.072 432.648 14.072ZM432.876 13.196C433.188 13.196 433.508 13.04 433.836 12.728C434.164 12.408 434.44 11.888 434.664 11.168L434.844 9.596C434.868 9.348 434.896 9.148 434.928 8.996C434.536 8.684 434.072 8.528 433.536 8.528C433.136 8.528 432.796 8.664 432.516 8.936C432.244 9.208 432.036 9.564 431.892 10.004C431.756 10.444 431.688 10.912 431.688 11.408C431.688 12.048 431.796 12.508 432.012 12.788C432.228 13.06 432.516 13.196 432.876 13.196ZM438.695 14.072C438.327 14.072 438.059 13.976 437.891 13.784C437.723 13.592 437.639 13.284 437.639 12.86C437.639 12.708 437.643 12.588 437.651 12.5L438.395 5.24C438.403 5.144 438.447 5.076 438.527 5.036C438.615 4.996 438.739 4.976 438.899 4.976H438.947C439.275 4.976 439.427 5.064 439.403 5.24L438.635 12.716C438.595 13.06 438.699 13.232 438.947 13.232C439.043 13.232 439.131 13.22 439.211 13.196C439.299 13.164 439.359 13.148 439.391 13.148C439.439 13.148 439.463 13.18 439.463 13.244C439.463 13.356 439.447 13.5 439.415 13.676C439.391 13.812 439.299 13.912 439.139 13.976C438.987 14.04 438.839 14.072 438.695 14.072ZM441.994 14.072C441.714 14.072 441.482 13.984 441.298 13.808C441.122 13.632 441.034 13.352 441.034 12.968C441.034 12.848 441.038 12.756 441.046 12.692L441.514 7.964C441.522 7.868 441.566 7.8 441.646 7.76C441.734 7.72 441.858 7.7 442.018 7.7H442.066C442.234 7.7 442.354 7.724 442.426 7.772C442.498 7.812 442.53 7.876 442.522 7.964L442.054 12.716L442.042 12.86C442.042 12.988 442.066 13.084 442.114 13.148C442.162 13.204 442.238 13.232 442.342 13.232C442.438 13.232 442.526 13.22 442.606 13.196C442.694 13.164 442.754 13.148 442.786 13.148C442.834 13.148 442.858 13.18 442.858 13.244C442.858 13.356 442.842 13.5 442.81 13.676C442.786 13.812 442.69 13.912 442.522 13.976C442.362 14.04 442.186 14.072 441.994 14.072ZM442.114 6.86C441.762 6.86 441.594 6.772 441.61 6.596L441.682 5.876C441.698 5.7 441.886 5.612 442.246 5.612C442.43 5.612 442.558 5.636 442.63 5.684C442.71 5.724 442.746 5.788 442.738 5.876L442.666 6.596C442.65 6.772 442.466 6.86 442.114 6.86ZM443.813 14C443.773 14 443.729 13.94 443.681 13.82C443.633 13.692 443.609 13.568 443.609 13.448C443.609 13.36 443.629 13.296 443.669 13.256L447.665 8.588H444.593C444.433 8.588 444.365 8.48 444.389 8.264L444.425 7.964C444.433 7.9 444.461 7.844 444.509 7.796C444.565 7.748 444.629 7.724 444.701 7.724H448.901C448.949 7.724 448.989 7.788 449.021 7.916C449.061 8.044 449.081 8.172 449.081 8.3C449.081 8.372 449.049 8.448 448.985 8.528L445.049 13.136H448.349C448.509 13.136 448.577 13.244 448.553 13.46L448.517 13.76C448.509 13.832 448.481 13.892 448.433 13.94C448.385 13.98 448.325 14 448.253 14H443.813ZM451.562 14.072C451.258 14.072 450.954 13.996 450.65 13.844C450.346 13.684 450.086 13.412 449.87 13.028C449.662 12.644 449.558 12.128 449.558 11.48C449.558 10.736 449.678 10.076 449.918 9.5C450.166 8.916 450.51 8.464 450.95 8.144C451.398 7.816 451.914 7.652 452.498 7.652C453.058 7.652 453.566 7.868 454.022 8.3C454.094 8.084 454.162 7.932 454.226 7.844C454.298 7.748 454.41 7.7 454.562 7.7H454.634C454.754 7.7 454.834 7.728 454.874 7.784C454.922 7.84 454.938 7.936 454.922 8.072L454.454 12.716C454.414 13.06 454.518 13.232 454.766 13.232C454.862 13.232 454.95 13.22 455.03 13.196C455.118 13.164 455.178 13.148 455.21 13.148C455.258 13.148 455.282 13.18 455.282 13.244C455.282 13.356 455.266 13.5 455.234 13.676C455.21 13.812 455.118 13.912 454.958 13.976C454.806 14.04 454.658 14.072 454.514 14.072C454.13 14.072 453.85 13.964 453.674 13.748C453.498 13.532 453.418 13.208 453.434 12.776C453.202 13.224 452.922 13.552 452.594 13.76C452.274 13.968 451.93 14.072 451.562 14.072ZM451.79 13.196C452.102 13.196 452.422 13.04 452.75 12.728C453.078 12.408 453.354 11.888 453.578 11.168L453.758 9.596C453.782 9.348 453.81 9.148 453.842 8.996C453.45 8.684 452.986 8.528 452.45 8.528C452.05 8.528 451.71 8.664 451.43 8.936C451.158 9.208 450.95 9.564 450.806 10.004C450.67 10.444 450.602 10.912 450.602 11.408C450.602 12.048 450.71 12.508 450.926 12.788C451.142 13.06 451.43 13.196 451.79 13.196ZM457.981 14.072C457.093 14.072 456.649 13.624 456.649 12.728C456.649 12.664 456.657 12.552 456.673 12.392L457.069 8.588H456.457C456.297 8.588 456.229 8.48 456.253 8.264L456.277 8.084C456.293 7.956 456.321 7.864 456.361 7.808C456.409 7.752 456.477 7.724 456.565 7.724H457.177L457.429 6.464C457.445 6.368 457.485 6.3 457.549 6.26C457.621 6.22 457.733 6.2 457.885 6.2H457.921C458.073 6.2 458.177 6.224 458.233 6.272C458.289 6.312 458.309 6.38 458.293 6.476L458.161 7.724H459.145C459.241 7.724 459.305 7.752 459.337 7.808C459.377 7.864 459.389 7.956 459.373 8.084L459.361 8.228C459.337 8.468 459.245 8.588 459.085 8.588H458.065L457.669 12.44C457.661 12.488 457.657 12.556 457.657 12.644C457.657 12.86 457.705 13.012 457.801 13.1C457.905 13.188 458.045 13.232 458.221 13.232C458.373 13.232 458.497 13.22 458.593 13.196C458.689 13.164 458.753 13.148 458.785 13.148C458.833 13.148 458.857 13.18 458.857 13.244C458.857 13.356 458.841 13.5 458.809 13.676C458.785 13.812 458.689 13.912 458.521 13.976C458.361 14.04 458.181 14.072 457.981 14.072ZM461.447 14.072C461.167 14.072 460.935 13.984 460.751 13.808C460.575 13.632 460.487 13.352 460.487 12.968C460.487 12.848 460.491 12.756 460.499 12.692L460.967 7.964C460.975 7.868 461.019 7.8 461.099 7.76C461.187 7.72 461.311 7.7 461.471 7.7H461.519C461.687 7.7 461.807 7.724 461.879 7.772C461.951 7.812 461.983 7.876 461.975 7.964L461.507 12.716L461.495 12.86C461.495 12.988 461.519 13.084 461.567 13.148C461.615 13.204 461.691 13.232 461.795 13.232C461.891 13.232 461.979 13.22 462.059 13.196C462.147 13.164 462.207 13.148 462.239 13.148C462.287 13.148 462.311 13.18 462.311 13.244C462.311 13.356 462.295 13.5 462.263 13.676C462.239 13.812 462.143 13.912 461.975 13.976C461.815 14.04 461.639 14.072 461.447 14.072ZM461.567 6.86C461.215 6.86 461.047 6.772 461.063 6.596L461.135 5.876C461.151 5.7 461.339 5.612 461.699 5.612C461.883 5.612 462.011 5.636 462.083 5.684C462.163 5.724 462.199 5.788 462.191 5.876L462.119 6.596C462.103 6.772 461.919 6.86 461.567 6.86ZM466.123 14.072C465.291 14.072 464.647 13.836 464.191 13.364C463.743 12.892 463.519 12.228 463.519 11.372C463.519 10.3 463.767 9.412 464.263 8.708C464.767 8.004 465.535 7.652 466.567 7.652C467.367 7.652 467.987 7.892 468.427 8.372C468.875 8.844 469.099 9.512 469.099 10.376C469.099 11.584 468.839 12.504 468.319 13.136C467.807 13.76 467.075 14.072 466.123 14.072ZM466.183 13.208C467.431 13.208 468.055 12.272 468.055 10.4C468.055 9.784 467.915 9.316 467.635 8.996C467.363 8.676 466.963 8.516 466.435 8.516C465.803 8.516 465.331 8.76 465.019 9.248C464.707 9.736 464.551 10.432 464.551 11.336C464.551 11.944 464.691 12.408 464.971 12.728C465.251 13.048 465.655 13.208 466.183 13.208ZM475.943 13.148C475.991 13.148 476.015 13.18 476.015 13.244C476.015 13.356 475.999 13.5 475.967 13.676C475.943 13.812 475.851 13.912 475.691 13.976C475.539 14.04 475.391 14.072 475.247 14.072C474.535 14.072 474.179 13.692 474.179 12.932C474.179 12.812 474.183 12.72 474.191 12.656L474.491 9.572C474.499 9.532 474.503 9.472 474.503 9.392C474.503 9.096 474.423 8.88 474.263 8.744C474.103 8.6 473.879 8.528 473.591 8.528C473.263 8.528 472.919 8.676 472.559 8.972C472.207 9.268 471.915 9.764 471.683 10.46L471.335 13.76C471.327 13.848 471.279 13.916 471.191 13.964C471.103 14.004 470.983 14.024 470.831 14.024H470.783C470.471 14.024 470.323 13.932 470.339 13.748L470.723 10.148C470.811 9.324 470.855 8.78 470.855 8.516C470.855 8.372 470.851 8.276 470.843 8.228C470.843 8.172 470.843 8.132 470.843 8.108C470.843 7.996 470.923 7.924 471.083 7.892C471.243 7.852 471.387 7.832 471.515 7.832C471.723 7.832 471.827 8.1 471.827 8.636V8.864C472.419 8.056 473.127 7.652 473.951 7.652C474.471 7.652 474.863 7.784 475.127 8.048C475.391 8.312 475.523 8.684 475.523 9.164C475.523 9.292 475.519 9.388 475.511 9.452L475.187 12.716C475.147 13.06 475.251 13.232 475.499 13.232C475.595 13.232 475.683 13.22 475.763 13.196C475.851 13.164 475.911 13.148 475.943 13.148Z"
        fill="#8B9597"
      />
      <path
        d="M457.216 103.024C456.848 103.024 456.664 102.924 456.664 102.724V95.704H454.468C454.372 95.704 454.304 95.672 454.264 95.608C454.224 95.536 454.204 95.424 454.204 95.272V95.032C454.204 94.88 454.224 94.772 454.264 94.708C454.304 94.636 454.372 94.6 454.468 94.6H460.12C460.216 94.6 460.284 94.636 460.324 94.708C460.364 94.772 460.384 94.88 460.384 95.032V95.272C460.384 95.424 460.364 95.536 460.324 95.608C460.284 95.672 460.216 95.704 460.12 95.704H457.948V102.724C457.948 102.924 457.764 103.024 457.396 103.024H457.216ZM463.174 103.084C462.254 103.084 461.554 102.812 461.074 102.268C460.594 101.716 460.354 100.92 460.354 99.88C460.354 98.84 460.598 98.04 461.086 97.48C461.574 96.92 462.27 96.64 463.174 96.64C464.078 96.64 464.766 96.92 465.238 97.48C465.718 98.032 465.958 98.832 465.958 99.88C465.958 100.92 465.722 101.716 465.25 102.268C464.778 102.812 464.086 103.084 463.174 103.084ZM463.15 102.064C463.678 102.064 464.066 101.884 464.314 101.524C464.57 101.164 464.698 100.612 464.698 99.868C464.698 99.124 464.57 98.572 464.314 98.212C464.066 97.844 463.678 97.66 463.15 97.66C462.63 97.66 462.246 97.844 461.998 98.212C461.75 98.572 461.626 99.124 461.626 99.868C461.626 100.612 461.746 101.164 461.986 101.524C462.234 101.884 462.622 102.064 463.15 102.064ZM469.466 103.084C469.01 103.084 468.606 102.952 468.254 102.688C467.91 102.416 467.642 102.036 467.45 101.548C467.258 101.06 467.162 100.5 467.162 99.868C467.162 99.196 467.262 98.62 467.462 98.14C467.67 97.652 467.958 97.28 468.326 97.024C468.694 96.768 469.126 96.64 469.622 96.64C469.942 96.64 470.226 96.688 470.474 96.784C470.73 96.88 470.974 97.016 471.206 97.192V94.264C471.206 94.064 471.386 93.964 471.746 93.964H471.878C472.246 93.964 472.43 94.064 472.43 94.264V101.128C472.43 101.664 472.454 102.052 472.502 102.292C472.55 102.532 472.574 102.668 472.574 102.7C472.574 102.812 472.474 102.892 472.274 102.94C472.074 102.988 471.89 103.012 471.722 103.012C471.602 103.012 471.514 102.952 471.458 102.832C471.41 102.712 471.37 102.588 471.338 102.46C471.314 102.324 471.298 102.232 471.29 102.184C470.762 102.784 470.154 103.084 469.466 103.084ZM469.766 102.04C470.014 102.04 470.262 101.972 470.51 101.836C470.758 101.692 470.99 101.496 471.206 101.248V98.128C470.822 97.832 470.39 97.684 469.91 97.684C469.422 97.684 469.054 97.864 468.806 98.224C468.558 98.584 468.434 99.108 468.434 99.796C468.434 100.516 468.546 101.072 468.77 101.464C469.002 101.848 469.334 102.04 469.766 102.04ZM475.891 103.084C475.283 103.084 474.803 102.932 474.451 102.628C474.099 102.316 473.923 101.872 473.923 101.296C473.923 100.488 474.259 99.924 474.931 99.604C475.603 99.276 476.543 99.108 477.751 99.1V98.584C477.751 98.304 477.655 98.08 477.463 97.912C477.271 97.744 476.963 97.66 476.539 97.66C476.211 97.66 475.923 97.7 475.675 97.78C475.435 97.852 475.227 97.932 475.051 98.02C474.883 98.1 474.787 98.14 474.763 98.14C474.675 98.14 474.571 98.048 474.451 97.864C474.339 97.672 474.283 97.528 474.283 97.432C474.283 97.32 474.387 97.204 474.595 97.084C474.811 96.956 475.091 96.852 475.435 96.772C475.787 96.684 476.159 96.64 476.551 96.64C477.343 96.64 477.943 96.812 478.351 97.156C478.767 97.492 478.975 97.96 478.975 98.56V101.128C478.975 101.664 478.999 102.052 479.047 102.292C479.095 102.532 479.119 102.668 479.119 102.7C479.119 102.812 479.019 102.892 478.819 102.94C478.627 102.988 478.447 103.012 478.279 103.012C478.151 103.012 478.059 102.952 478.003 102.832C477.955 102.712 477.915 102.584 477.883 102.448C477.859 102.312 477.843 102.22 477.835 102.172C477.619 102.428 477.347 102.644 477.019 102.82C476.699 102.996 476.323 103.084 475.891 103.084ZM476.095 102.052C476.447 102.052 476.755 101.98 477.019 101.836C477.283 101.692 477.527 101.496 477.751 101.248V100.048C476.975 100.048 476.355 100.124 475.891 100.276C475.427 100.42 475.195 100.728 475.195 101.2C475.195 101.472 475.271 101.684 475.423 101.836C475.583 101.98 475.807 102.052 476.095 102.052ZM484.95 96.7C485.31 96.7 485.49 96.772 485.49 96.916C485.49 96.956 485.478 97.02 485.454 97.108L482.466 105.232C482.41 105.4 482.214 105.484 481.878 105.484H481.686C481.358 105.484 481.194 105.416 481.194 105.28C481.194 105.256 481.214 105.188 481.254 105.076L482.19 102.748L480.126 97.096C480.102 97 480.09 96.94 480.09 96.916C480.09 96.772 480.282 96.7 480.666 96.7H480.846C481.158 96.7 481.334 96.768 481.374 96.904L482.454 99.868C482.558 100.14 482.682 100.564 482.826 101.14H482.85L482.946 100.816C483.058 100.424 483.154 100.108 483.234 99.868L484.29 96.904C484.33 96.768 484.514 96.7 484.842 96.7H484.95Z"
        fill="#8B9597"
      />
      <path
        d="M15 100L20 102.887L20 97.1132L15 100ZM447 99.5L19.5 99.5L19.5 100.5L447 100.5L447 99.5Z"
        fill="#B3BDBF"
      />
    </svg>
  );
}
